@inject IJSRuntime JS

<!-- Bootstrap Modal for Delete Confirmation -->
<div class="modal fade" id="deleteConfirmModal" tabindex="-1" role="dialog" data-backdrop="static" style="z-index: 3000;">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">
                    <i class="feather icon-alert-triangle"></i> @Title
                </h5>
                <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close" @onclick="Cancel">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="text-center py-3">
                    <i class="feather icon-alert-circle text-danger" style="font-size: 48px;"></i>
                    <p class="mt-3 mb-0" style="font-size: 16px;">@Message</p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal" @onclick="Cancel" disabled="@IsProcessing">
                    <i class="feather icon-x"></i> 
                    <span>Hủy</span>
                </button>
                <button type="button" class="btn btn-danger" @onclick="Confirm" disabled="@IsProcessing">
                    @if (IsProcessing)
                    {
                        <span class="spinner-border spinner-border-sm me-1"></span>
                        <span>Đang xử lý...</span>
                    }
                    else
                    {
                        <i class="feather icon-trash-2"></i>
                        <span>Xóa</span>
                    }
                </button>
            </div>
        </div>
    </div>
</div>

@code {
    [Parameter]
    public string Title { get; set; } = "Xác nhận xóa";

    [Parameter]
    public EventCallback OnConfirm { get; set; }

    [Parameter]
    public bool IsProcessing { get; set; }

    private string Message { get; set; } = string.Empty;

    /// <summary>
    /// Hiển thị dialog với message cụ thể
    /// </summary>
    /// <param name="message">Nội dung xác nhận</param>
    public async Task Show(string message)
    {
        Message = message;
        StateHasChanged();
        await JS.InvokeVoidAsync("eval", "$('#deleteConfirmModal').modal('show')");
    }

    /// <summary>
    /// Ẩn dialog
    /// </summary>
    public async Task Hide()
    {
        await JS.InvokeVoidAsync("eval", "$('#deleteConfirmModal').modal('hide')");
        Message = string.Empty;
        StateHasChanged();
    }

    private async Task Confirm()
    {
        if (OnConfirm.HasDelegate)
        {
            await OnConfirm.InvokeAsync();
        }
        await Hide();
    }

    private async Task Cancel()
    {
        await Hide();
    }
}
